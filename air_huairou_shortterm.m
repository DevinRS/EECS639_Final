% Location #1: huairou (30d period)
y_real = [
6
6
8
10
15
15
15
15
14
17
18
17
15
15
9
5
2
2
4
7
8
7
8
5
3
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
8
9
8
6
4
4
3
5
5
6
5
4
3
2
2
2
2
2
2
2
3
4
5
4
3
3
4
5
7
6
5
5
5
4
2
2
2
2
2
2
2
2
4
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
4
4
4
6
6
5
4
5
6
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
6
9
9
9
7
4
4
4
4.5
5
6
5
5
5
4
4
4
5
4
4
4
4
4
4
5
6
5
7
7
12
17
14
14
16
18
20
17
15
13
9
4
5
4
4
3
4
4
5
6
8
8
5
5
3
3
6
6
6
6
5
6
5
4
3
2
2
2
2
2
2
2
2
2
2
4
4
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
4
2
2
2
3
2
2
4
4
4
4
5
4
7
6
2
2
3
3
3
2
2
2
2
2
2
3
3
3
2
2
3
2
3
3
4
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
5.5
5.5
9
12
11
11
12
14
14
12
9
7
6
5
6
5
3
2
2
2
2
2
2
4
6
13
20
17
17
18
20
17
14
12
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
3
4
4
3
3
3
3
4
4
4
4
3
3
3
3
3
3
3
3
3
3
3
3
3
2
3
3
3
3
3
3
2
2
2
3
2
3
3
3
4
3
3
2
3
4
4
5
4
4
3
4
4
5
4
4
4
5
4
4
4
3
3
3
3
3
3
3
4
5
4
4
4
4
3
3
3
3
3
3
4
4
4
4
3
3
3
3
3
3
3
3
3
4
4
4
5
5
6
8
6
5
4
6
7
7
9
9
8
10
8
9
6
6
5
6
8
10
11
22
27
27
28
25
20
17
15
13
15
18
16
14
11
10
12
12
11
9
10
10
11
16
22
31
29
28
25
28
30
29
22
12
10
8
6
9
13
14
14
11
12
10
8
8
9
10
11
13
11
10
8
8
7
6
5
5
5
6
5
4
3
2
2
3
2
2
2
2
2
3
5
7
9
9
11
15
10
11
7
4
4
4
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
8
11
9
8
8
7
8
6
5
4
2
2
6
7
9
11
9
6
6
6
8
12
14
16
18
19
21
20
16
10
9
10
10
12
13
13
11
9
6
4
3
3
2
2
3
5
11
13
7
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2    
];

% check length
disp(length(y_real));

% Location #1: huairou HR6 (30d period)
x = linspace(1, 30, 30);
y = [6 3 3 5 2 2 2 2 4 5 2 3 2 2 2 2 2 3 2 3 3 6 10 8 2 2 2 6 2 2];
x_vals = linspace(1, 30, 697);

disp('Running Natural Cubic Spline Interpolation: huairou HR6 (30d period)');
coeff_spline = natural_cubic_spline_interpolation(x, y);
y_vals_spline = natural_cubic_spline_interpolation_eval(coeff_spline, x, x_vals);
subplot(1, 3, 1);
plot(x_vals, y_vals_spline, 'r', x, y, 'bo', x_vals, y_real, 'g');
title('huairou HR6 (30d period)');
xlabel('days');
ylabel('SO2 levels');
legend('Interpolating Polynomial', 'Data Points', 'Real Value', 'Location', 'northwest');
legend('boxoff');
grid on;

% calculate the error
error = norm(y_vals_spline - y_real, 2);
disp("Error: " + error);

% Location #1: huairou HR12 (30d period)
y_real = [15
15
14
17
18
17
15
15
9
5
2
2
4
7
8
7
8
5
3
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
8
9
8
6
4
4
3
5
5
6
5
4
3
2
2
2
2
2
2
2
3
4
5
4
3
3
4
5
7
6
5
5
5
4
2
2
2
2
2
2
2
2
4
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
4
4
4
6
6
5
4
5
6
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
6
9
9
9
7
4
4
4
4.5
5
6
5
5
5
4
4
4
5
4
4
4
4
4
4
5
6
5
7
7
12
17
14
14
16
18
20
17
15
13
9
4
5
4
4
3
4
4
5
6
8
8
5
5
3
3
6
6
6
6
5
6
5
4
3
2
2
2
2
2
2
2
2
2
2
4
4
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
4
2
2
2
3
2
2
4
4
4
4
5
4
7
6
2
2
3
3
3
2
2
2
2
2
2
3
3
3
2
2
3
2
3
3
4
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
5.5
5.5
9
12
11
11
12
14
14
12
9
7
6
5
6
5
3
2
2
2
2
2
2
4
6
13
20
17
17
18
20
17
14
12
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
3
4
4
3
3
3
3
4
4
4
4
3
3
3
3
3
3
3
3
3
3
3
3
3
2
3
3
3
3
3
3
2
2
2
3
2
3
3
3
4
3
3
2
3
4
4
5
4
4
3
4
4
5
4
4
4
5
4
4
4
3
3
3
3
3
3
3
4
5
4
4
4
4
3
3
3
3
3
3
4
4
4
4
3
3
3
3
3
3
3
3
3
4
4
4
5
5
6
8
6
5
4
6
7
7
9
9
8
10
8
9
6
6
5
6
8
10
11
22
27
27
28
25
20
17
15
13
15
18
16
14
11
10
12
12
11
9
10
10
11
16
22
31
29
28
25
28
30
29
22
12
10
8
6
9
13
14
14
11
12
10
8
8
9
10
11
13
11
10
8
8
7
6
5
5
5
6
5
4
3
2
2
3
2
2
2
2
2
3
5
7
9
9
11
15
10
11
7
4
4
4
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
8
11
9
8
8
7
8
6
5
4
2
2
6
7
9
11
9
6
6
6
8
12
14
16
18
19
21
20
16
10
9
10
10
12
13
13
11
9
6
4
3
3
2
2
3
5
11
13
7
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
];
x = linspace(1, 30, 30);
y = [15 2 3 2 4 2 2 4 12 3 2 3 3 2 12 17 9.5 2 4 4 5 27 28 10 9 2 8 18 7 2];
x_vals = linspace(1, 30, 697);

disp('Running Natural Cubic Spline Interpolation: huairou HR12 (30d period)');
coeff_spline = natural_cubic_spline_interpolation(x, y);
y_vals_spline = natural_cubic_spline_interpolation_eval(coeff_spline, x, x_vals);
subplot(1, 3, 2);
plot(x_vals, y_vals_spline, 'r', x, y, 'bo', x_vals, y_real, 'g');
title('huairou HR12 (30d period)');
xlabel('days');
ylabel('SO2 levels');
legend('Interpolating Polynomial', 'Data Points', 'Real Value', 'Location', 'northwest');
legend('boxoff');
grid on;

% calculate the error
error = norm(y_vals_spline - y_real, 2);
disp("Error: " + error);

% Location #1: huairou HR18 (30d period)
y_real = [15
15
9
5
2
2
4
7
8
7
8
5
3
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
8
9
8
6
4
4
3
5
5
6
5
4
3
2
2
2
2
2
2
2
3
4
5
4
3
3
4
5
7
6
5
5
5
4
2
2
2
2
2
2
2
2
4
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
4
4
4
6
6
5
4
5
6
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
6
9
9
9
7
4
4
4
4.5
5
6
5
5
5
4
4
4
5
4
4
4
4
4
4
5
6
5
7
7
12
17
14
14
16
18
20
17
15
13
9
4
5
4
4
3
4
4
5
6
8
8
5
5
3
3
6
6
6
6
5
6
5
4
3
2
2
2
2
2
2
2
2
2
2
4
4
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
4
2
2
2
3
2
2
4
4
4
4
5
4
7
6
2
2
3
3
3
2
2
2
2
2
2
3
3
3
2
2
3
2
3
3
4
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
5.5
5.5
9
12
11
11
12
14
14
12
9
7
6
5
6
5
3
2
2
2
2
2
2
4
6
13
20
17
17
18
20
17
14
12
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
3
4
4
3
3
3
3
4
4
4
4
3
3
3
3
3
3
3
3
3
3
3
3
3
2
3
3
3
3
3
3
2
2
2
3
2
3
3
3
4
3
3
2
3
4
4
5
4
4
3
4
4
5
4
4
4
5
4
4
4
3
3
3
3
3
3
3
4
5
4
4
4
4
3
3
3
3
3
3
4
4
4
4
3
3
3
3
3
3
3
3
3
4
4
4
5
5
6
8
6
5
4
6
7
7
9
9
8
10
8
9
6
6
5
6
8
10
11
22
27
27
28
25
20
17
15
13
15
18
16
14
11
10
12
12
11
9
10
10
11
16
22
31
29
28
25
28
30
29
22
12
10
8
6
9
13
14
14
11
12
10
8
8
9
10
11
13
11
10
8
8
7
6
5
5
5
6
5
4
3
2
2
3
2
2
2
2
2
3
5
7
9
9
11
15
10
11
7
4
4
4
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
3
3
8
11
9
8
8
7
8
6
5
4
2
2
6
7
9
11
9
6
6
6
8
12
14
16
18
19
21
20
16
10
9
10
10
12
13
13
11
9
6
4
3
3
2
2
3
5
11
13
7
3
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
];
x = linspace(1, 30, 30);
y = [15 2 2 4 6 2 2 5 20 5 2 4 3 2 12 12 3 3 4 3 6 13 12 5 4 2 8 9 2 2];
x_vals = linspace(1, 30, 697);

disp('Running Natural Cubic Spline Interpolation: huairou HR18 (30d period)');
coeff_spline = natural_cubic_spline_interpolation(x, y);
y_vals_spline = natural_cubic_spline_interpolation_eval(coeff_spline, x, x_vals);
subplot(1, 3, 3);
plot(x_vals, y_vals_spline, 'r', x, y, 'bo', x_vals, y_real, 'g');
title('huairou HR18 (30d period)');
xlabel('days');
ylabel('SO2 levels');
legend('Interpolating Polynomial', 'Data Points', 'Real Value', 'Location', 'northwest');
legend('boxoff');
grid on;

% calculate the error
error = norm(y_vals_spline - y_real, 2);
disp("Error: " + error);




